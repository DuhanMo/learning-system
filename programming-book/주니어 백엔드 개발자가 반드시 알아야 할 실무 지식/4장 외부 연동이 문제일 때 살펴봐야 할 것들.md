# 4장 외부 연동이 문제일 때 살펴봐야 할 것들

## 핵심 요약
- 연동 서비스를 호출할 땐 타임아웃을 적절히 설정해야 한다
- 네트워크 통신 과정에서 간헐적으로 연결에 실패하거나 일시적인 응답지연인 경우 재시도를 할 수 있다
- 연동 서비스에 부하가 걸려 레이턴시가 늦어지면, 요청을 일정 수준 이하로 줄여야 한다
- 서킷브레이커를 활용해 연동 서비스가 장애상황일 때를 대응할 수 있다
- DB 연동과 외부 연동을 함께 실행할 땐 오류발생시 DB트랜잭션 처리를 고려해야 한다
- 외부 연동 폴백으로 연동 서비스 이중화를 고려할 수 있다

## 주요 개념
- 타임아웃(connection timeout, read timeout)
- 재시도, 재시도 가능조건, 재시도 횟수와 간격, 재시도 폭풍 안티패턴
- 동시 요청 제한, 벌크 헤드, 503
- 서킷 브레이커
- HTTP 커넥션 풀
- 연동 서비스 이중화

## 메모
- 재시도를 해도 되는 조건
    - 단순 조회 기능
    - connection timeout
    - 멱등성을 가진 변경 기능
- 트랜잭션 실패, 외부 서비스 성공시
    - 일정 주기로 데이터 일치하는지 확인 후 보정
    -  일정 시간 후 이전 호출이 성공했는지 성공 확인 API 호출
- DB 트랜잭션과 별개로 외부 연동을 실행한다면, 후처리를 고민해야 한다
    - 트랜잭션을 되돌리는 보상트랜잭션
    - 데이터를 후보정